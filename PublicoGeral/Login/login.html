<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, inicial-scale=1.0">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>


<body>

    <header>
        <div class="item_header">
            <img src="../imagens/logo2.jpg" alt="Logo Clínica" id="logo">
        </div>
    </header>

    <nav>
        <div class="conteiner">
            <div class="item">
                <a href="../Home/Home.html">Home</a>
            </div>
            <div class="item">
                <a href="../Galeria/Galeria.html">Galeria</a>
            </div>
            <div class="item">
                <a href="../Agendamento/agendarConsulta.php">Agendar consulta</a>
            </div>
            <div class="item">
                <a href="../NovoEndereco/cadastroEnderecos.html">Cadastro de endereço</a>
            </div>
        </div>
    </nav>

    <main>
        <h2>Login</h2>

        <form id="cadastro" method="POST" action="cadastraCliente.php" enctype="multipart/form-data">
            <fieldset>
                <!--<legend class="campo">Endereço de Entrega</legend>-->
                <div>
                    <label for="email">E-mail:</label>
                    <input type="email" id="email" name="email">
                    <span></span>
                </div>
                <div>
                    <label for="senha">Senha:</label>
                    <input type="password" id="senha" name="senha">
                    <span></span>
                </div>
            </fieldset>

            <button id="botao" type="submit">Entrar</button>
            <div id = "sla" style="display: none;">
                <span>E-mail e/ou senha incorreta. Por favor, tente novamente.</span>
            </div>

        </form>

    </main>

    <footer>
        <address>Avenida João Naves de Ávila 2121, Santa Mônica, Uberlândia</address>
    </footer>

     <script>

        function sendForm(form) {
          
          let xhr = new XMLHttpRequest();
          
          xhr.open("POST", form.getAttribute("action"));
          xhr.responseType = 'json';
          
    
          xhr.onload = function () {
            if (xhr.status != 200 || xhr.response === null) {
              console.log("A resposta não pode ser obtida ");
              console.log(xhr.status);
              return;
            }
    
            let loginResponse = xhr.response;
            if (loginResponse.success)
              window.location = loginResponse.detail;
            if(loginResponse.success == false){
              document.querySelector("#sla").style.display = 'block';
              form.senha.value = "";
              form.senha.focus();
            }
          }      
    
          xhr.onerror = function () {
            console.error("Erro de rede - requisição não finalizada");
          };
    
          xhr.send(new FormData(form));
        }
    
        window.onload = function () {
          const form = document.querySelector("#cadastro");
          form.onsubmit = function (e) {
            sendForm(form);
            e.preventDefault();
          }
        }
    
      </script> 
    

</body>


</html>